{
    "manifests": {
        "frosh/devenv-meta": {
            "manifest": {
                "copy-from-recipe": {
                    "root/": ""
                },
                "gitignore": [
                    ".devenv*",
                    "devenv.local.nix"
                ],
                "post-install-output": [
                    "  * <fg=blue>Setup</> devenv:",
                    "    ",
                    "    1. Install the Nix package manager - <comment>https://nixos.org/download.html#download-nix</>",
                    "    2. Install devenv - <comment>https://devenv.sh/getting-started/</>",
                    "  ",
                    "  * <fg=blue>Run</> devenv:",
                    "    ",
                    "    1. <comment>devenv shell</> activates your developer environment",
                    "    2. <comment>devenv up</> starts processes",
                    "",
                    "  * <fg=blue>Read</> the documentation at <comment>https://devenv.sh/getting-started/</>"
                ]
            },
            "files": {
                "root/.envrc": {
                    "contents": [
                        "export NIXPKGS_ALLOW_UNFREE=1",
                        "",
                        "watch_file devenv.nix",
                        "watch_file devenv.yaml",
                        "watch_file devenv.lock",
                        "eval \"$(devenv print-dev-env)\"",
                        ""
                    ],
                    "executable": false
                },
                "root/devenv.lock": {
                    "contents": [
                        "{",
                        "  \"nodes\": {",
                        "    \"devenv\": {",
                        "      \"locked\": {",
                        "        \"dir\": \"src/modules\",",
                        "        \"lastModified\": 1675796338,",
                        "        \"narHash\": \"sha256-mdpCcy/FhD1MFN10R9vSl+YNSFOcMjdTklD+cYeVtQ4=\",",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"devenv\",",
                        "        \"rev\": \"5c0f94be41dd900ef473bcda7719e2995e7a9539\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"dir\": \"src/modules\",",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"devenv\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"flake-compat\": {",
                        "      \"flake\": false,",
                        "      \"locked\": {",
                        "        \"lastModified\": 1673956053,",
                        "        \"narHash\": \"sha256-4gtG9iQuiKITOjNQQeQIpoIB6b16fm+504Ch3sNKLd8=\",",
                        "        \"owner\": \"edolstra\",",
                        "        \"repo\": \"flake-compat\",",
                        "        \"rev\": \"35bb57c0c8d8b62bbfd284272c928ceb64ddbde9\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"edolstra\",",
                        "        \"repo\": \"flake-compat\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"flake-utils\": {",
                        "      \"locked\": {",
                        "        \"lastModified\": 1667395993,",
                        "        \"narHash\": \"sha256-nuEHfE/LcWyuSWnS8t12N1wc105Qtau+/OdUAjtQ0rA=\",",
                        "        \"owner\": \"numtide\",",
                        "        \"repo\": \"flake-utils\",",
                        "        \"rev\": \"5aed5285a952e0b949eb3ba02c12fa4fcfef535f\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"numtide\",",
                        "        \"repo\": \"flake-utils\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"gitignore\": {",
                        "      \"inputs\": {",
                        "        \"nixpkgs\": [",
                        "          \"pre-commit-hooks\",",
                        "          \"nixpkgs\"",
                        "        ]",
                        "      },",
                        "      \"locked\": {",
                        "        \"lastModified\": 1660459072,",
                        "        \"narHash\": \"sha256-8DFJjXG8zqoONA1vXtgeKXy68KdJL5UaXR8NtVMUbx8=\",",
                        "        \"owner\": \"hercules-ci\",",
                        "        \"repo\": \"gitignore.nix\",",
                        "        \"rev\": \"a20de23b925fd8264fd7fad6454652e142fd7f73\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"hercules-ci\",",
                        "        \"repo\": \"gitignore.nix\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"nixpkgs\": {",
                        "      \"locked\": {",
                        "        \"lastModified\": 1675698036,",
                        "        \"narHash\": \"sha256-BgsQkQewdlQi8gapJN4phpxkI/FCE/2sORBaFcYbp/A=\",",
                        "        \"owner\": \"NixOS\",",
                        "        \"repo\": \"nixpkgs\",",
                        "        \"rev\": \"1046c7b92e908a1202c0f1ba3fc21d19e1cf1b62\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"NixOS\",",
                        "        \"ref\": \"nixpkgs-unstable\",",
                        "        \"repo\": \"nixpkgs\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"nixpkgs-stable\": {",
                        "      \"locked\": {",
                        "        \"lastModified\": 1673800717,",
                        "        \"narHash\": \"sha256-SFHraUqLSu5cC6IxTprex/nTsI81ZQAtDvlBvGDWfnA=\",",
                        "        \"owner\": \"NixOS\",",
                        "        \"repo\": \"nixpkgs\",",
                        "        \"rev\": \"2f9fd351ec37f5d479556cd48be4ca340da59b8f\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"NixOS\",",
                        "        \"ref\": \"nixos-22.11\",",
                        "        \"repo\": \"nixpkgs\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"pre-commit-hooks\": {",
                        "      \"inputs\": {",
                        "        \"flake-compat\": \"flake-compat\",",
                        "        \"flake-utils\": \"flake-utils\",",
                        "        \"gitignore\": \"gitignore\",",
                        "        \"nixpkgs\": [",
                        "          \"nixpkgs\"",
                        "        ],",
                        "        \"nixpkgs-stable\": \"nixpkgs-stable\"",
                        "      },",
                        "      \"locked\": {",
                        "        \"lastModified\": 1675688762,",
                        "        \"narHash\": \"sha256-oit/SxMk0B380ASuztBGQLe8TttO1GJiXF8aZY9AYEc=\",",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"pre-commit-hooks.nix\",",
                        "        \"rev\": \"ab608394886fb04b8a5df3cb0bab2598400e3634\",",
                        "        \"type\": \"github\"",
                        "      },",
                        "      \"original\": {",
                        "        \"owner\": \"cachix\",",
                        "        \"repo\": \"pre-commit-hooks.nix\",",
                        "        \"type\": \"github\"",
                        "      }",
                        "    },",
                        "    \"root\": {",
                        "      \"inputs\": {",
                        "        \"devenv\": \"devenv\",",
                        "        \"nixpkgs\": \"nixpkgs\",",
                        "        \"pre-commit-hooks\": \"pre-commit-hooks\"",
                        "      }",
                        "    }",
                        "  },",
                        "  \"root\": \"root\",",
                        "  \"version\": 7",
                        "}",
                        ""
                    ],
                    "executable": false
                },
                "root/devenv.nix": {
                    "contents": [
                        "{ pkgs, lib, config, ... }:",
                        "",
                        "{",
                        "  packages = [",
                        "    pkgs.jq",
                        "    pkgs.gnupatch",
                        "  ];",
                        "",
                        "  languages.javascript.enable = lib.mkDefault true;",
                        "  languages.javascript.package = lib.mkDefault pkgs.nodejs-16_x;",
                        "  env.NODE_OPTIONS = lib.mkDefault \"--openssl-legacy-provider\";",
                        "",
                        "  languages.php = {",
                        "    enable = lib.mkDefault true;",
                        "    version = lib.mkDefault \"8.1\";",
                        "    extensions = lib.mkDefault [ \"amqp\" \"redis\" ];",
                        "",
                        "    ini = ''",
                        "      memory_limit = 2G",
                        "      pdo_mysql.default_socket = ''${MYSQL_UNIX_PORT}",
                        "      mysqli.default_socket = ''${MYSQL_UNIX_PORT}",
                        "      realpath_cache_ttl = 3600",
                        "      session.gc_probability = 0",
                        "      ${lib.optionalString config.services.redis.enable ''",
                        "      session.save_handler = redis",
                        "      session.save_path = \"tcp://127.0.0.1:6379/0\"",
                        "      ''}",
                        "      display_errors = On",
                        "      error_reporting = E_ALL",
                        "      assert.active = 0",
                        "      opcache.memory_consumption = 256M",
                        "      opcache.interned_strings_buffer = 20",
                        "      zend.assertions = 0",
                        "      short_open_tag = 0",
                        "      zend.detect_unicode = 0",
                        "      realpath_cache_ttl = 3600",
                        "    '';",
                        "  };",
                        "",
                        "  languages.php.fpm.pools.web = lib.mkDefault {",
                        "    settings = {",
                        "      \"clear_env\" = \"no\";",
                        "      \"pm\" = \"dynamic\";",
                        "      \"pm.max_children\" = 10;",
                        "      \"pm.start_servers\" = 2;",
                        "      \"pm.min_spare_servers\" = 1;",
                        "      \"pm.max_spare_servers\" = 10;",
                        "    };",
                        "  };",
                        "",
                        "  services.caddy.enable = lib.mkDefault true;",
                        "  services.caddy.virtualHosts.\":8000\" = lib.mkDefault {",
                        "    extraConfig = ''",
                        "      root * public",
                        "      php_fastcgi unix/${config.languages.php.fpm.pools.web.socket}",
                        "      encode zstd gzip",
                        "      file_server",
                        "      log {",
                        "      \toutput stderr",
                        "      \tformat console",
                        "      \tlevel ERROR",
                        "      }",
                        "    '';",
                        "  };",
                        "",
                        "  services.mysql = {",
                        "    enable = true;",
                        "    initialDatabases = lib.mkDefault [{ name = \"shopware\"; }];",
                        "    ensureUsers = lib.mkDefault [",
                        "      {",
                        "        name = \"shopware\";",
                        "        password = \"shopware\";",
                        "        ensurePermissions = {",
                        "          \"shopware.*\" = \"ALL PRIVILEGES\";",
                        "          \"shopware_test.*\" = \"ALL PRIVILEGES\";",
                        "        };",
                        "      }",
                        "    ];",
                        "    settings = {",
                        "      mysqld = {",
                        "        log_bin_trust_function_creators = 1;",
                        "      };",
                        "    };",
                        "  };",
                        "",
                        "  services.redis.enable = lib.mkDefault true;",
                        "  services.adminer.enable = lib.mkDefault true;",
                        "  services.adminer.listen = lib.mkDefault \"127.0.0.1:8010\";",
                        "  services.mailhog.enable = lib.mkDefault true;",
                        "",
                        "  #services.rabbitmq.enable = true;",
                        "  #services.rabbitmq.managementPlugin.enable = true;",
                        "  #services.elasticsearch.enable = true;",
                        "",
                        "  # Environment variables",
                        "  env.MAILER_DSN = lib.mkDefault \"smtp://localhost:1025\";",
                        "  env.DATABASE_URL = lib.mkDefault \"mysql://shopware:shopware@localhost:3306/shopware\";",
                        "",
                        "  # Shopware 6 related scripts",
                        "  scripts.build-js.exec = lib.mkDefault \"bin/build-js.sh\";",
                        "  scripts.build-storefront.exec = lib.mkDefault \"bin/build-storefront.sh\";",
                        "  scripts.watch-storefront.exec = lib.mkDefault \"bin/watch-storefront.sh\";",
                        "  scripts.build-administration.exec = lib.mkDefault \"bin/build-administration.sh\";",
                        "  scripts.watch-administration.exec = lib.mkDefault \"bin/watch-administration.sh\";",
                        "  scripts.theme-refresh.exec = lib.mkDefault \"bin/console theme-refresh\";",
                        "  scripts.theme-compile.exec = lib.mkDefault \"bin/console theme-compile\";",
                        "",
                        "  # Symfony related scripts",
                        "  scripts.cc.exec = lib.mkDefault \"bin/console cache:clear\";",
                        "}",
                        ""
                    ],
                    "executable": false
                },
                "root/devenv.yaml": {
                    "contents": [
                        "inputs:",
                        "    nixpkgs:",
                        "        url: github:NixOS/nixpkgs/nixpkgs-unstable",
                        ""
                    ],
                    "executable": false
                }
            },
            "ref": "624c13cb29813f74109afaec92337419fe77eb41"
        }
    }
}
